<!doctype html>
<html>

<head>
    <title>CodeMirror: HTML completion demo</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../assets/bootstrap4/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/fontawesome5/css/all.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="../assets/bootstrap4/js/bootstrap.min.js"></script>

    <link rel=stylesheet href="doc/docs.css">

    <link rel="stylesheet" href="lib/codemirror.css">
    <link rel="stylesheet" href="addon/hint/show-hint.css">
    <script src="lib/codemirror-custom.js"></script>
    <script src="addon/hint/show-hint.js"></script>
    <script src="addon/hint/xml-hint.js"></script>
    <script src="addon/hint/html-hint.js"></script>
    <script src="mode/xml/xml.js"></script>
    <script src="mode/javascript/javascript.js"></script>
    <script src="mode/css/css.js"></script>
    <script src="mode/htmlmixed/htmlmixed.js"></script>
    <style>
        .CodeMirror {
            border-top: 1px solid #888;
            border-bottom: 1px solid #888;
            height: 600px;
        }
        
        #main {
            border: 1px solid #888;
            background-color: #ffffff;
            margin-left: 600px;
            height: 600px;
        }
        
        #sidebar {
            width: 600px;
            float: left;
            height: 600px;
        }
        
        #split-bar {
            height: 100%;
            float: right;
            width: 6px;
            cursor: col-resize;
        }
        
        .filetype-menu {
            display: block;
            width: 100%;
        }
        
        .filetype-menu li {
            float: left;
            list-style-type: none;
            cursor: pointer;
            padding: 5px 10px;
            margin-right: 5px;
            border-top: 1px solid #aaaaaa;
            border-left: 1px solid #aaaaaa;
            border-right: 1px solid #aaaaaa;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <h2>HTML completion demo</h2>

        <p>Shows the <a href="xmlcomplete.html">XML completer</a> parameterized with information about the tags in HTML. Press <strong>ctrl-space</strong> to activate completion.</p>
        <p><button id="runBtn" type="button" class="btn btn-primary">Run</button></p>
        <p>
            <div class="filetype-menu">
                <ul>
                    <li id="html_code_sheet" class="code-sheet">HTML</li>
                    <li id="css_code_sheet" class="code-sheet">CSS</li>
                    <li id="js_code_sheet" class="code-sheet">JS</li>
                </ul>
            </div>
        </p>
        <div class="clearfix"></div>
        <div id="sidebar">
            <div id="split-bar"></div>
            <form>
                <div id="test"></div>
                <textarea id="htmlcode" name="htmlcode" style="display:none">HTML...</textarea>
                <textarea id="csscode" name="csscode" style="display:none">CSS...</textarea>
                <textarea id="jscode" name="jscode" style="display:none">Java Script...</textarea>
            </form>
        </div>
        <div id="main"></div>
    </div>
    <script>
        var htmleditor = "";
        var csseditor = "";

        function run_update() {
            $('#main').html(htmleditor.getValue());
        }

        function load_project(name) {
            console.log(name + " Project Loading... ");
            try {
                $.get('projects/' + name + '/code.html', function(data) {
                    console.log(data);
                    $('textarea#htmlcode').val(data);
                    $('textarea#htmlcode').html(data);

                    initEditor();
                });
            } catch {

            }


            /*
            $.get('projects/' + name + '/code.css', function(data) {
                $('textarea#csscode').val(data);
                console.log($('textarea#csscode').val());
            })

            $.get('projects/' + name + '/code.js', function(data) {
                $('textarea#jscode').val(data);
                console.log($('textarea#jscode').val());
            })*/
        }

        function initEditor() {

            htmleditor = CodeMirror.fromTextArea(document.getElementById("htmlcode"), {
                lineNumbers: true,
                extraKeys: {
                    "Ctrl-Space": "autocomplete"
                }
            });

            csseditor = CodeMirror.fromTextArea(document.getElementById("csscode"), {
                lineNumbers: true,
                extraKeys: {
                    "Ctrl-Space": "autocomplete"
                },
                mode: "text/css",
            });

            jseditor = CodeMirror.fromTextArea(document.getElementById("jscode"), {
                lineNumbers: true,
                extraKeys: {
                    "Ctrl-Space": "autocomplete"
                },
                mode: {
                    name: "javascript",
                    globalVars: true
                }
            });

            csseditor.hide();
            jseditor.hide();

            run_update();
        };

        var min = 300;
        var max = 3600;
        var mainmin = 200;

        $('#split-bar').mousedown(function(e) {
            e.preventDefault();
            $(document).mousemove(function(e) {
                e.preventDefault();
                var x = e.pageX - $('#sidebar').offset().left;
                if (x > min && x < max && e.pageX < ($(window).width() - mainmin)) {
                    $('#sidebar').css("width", x);
                    $('#main').css("margin-left", x);
                }
            })
        });

        $(document).mouseup(function(e) {
            $(document).unbind('mousemove');
        });

        $(document).ready(function() {
            load_project("workshop-1");

            $('#runBtn').click(function() {
                run_update();
            });

            $('.code-sheet').click(function() {
                sheetid = $(this).attr("id");
                if (sheetid == "html_code_sheet") {
                    jseditor.hide();
                    csseditor.hide();
                    htmleditor.show();
                } else if (sheetid == "css_code_sheet") {
                    jseditor.hide();
                    htmleditor.hide();
                    csseditor.show();
                } else if (sheetid == "js_code_sheet") {
                    csseditor.hide();
                    htmleditor.hide();
                    jseditor.show();
                }
            })

        })
    </script>

</body>

</html>